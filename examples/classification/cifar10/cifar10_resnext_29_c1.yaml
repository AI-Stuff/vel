name: 'cifar10_resnetv1_32'


model:
  name: waterboy.models.classic.cifar_resnext
  img_channels: 3
  num_classes: 10

  mode: bottleneck # Basic or bottleneck
  blocks: [3, 3, 3] # ResNext29
  cardinality: 1
  inplanes: 256
  image_features: 64
  divisor: 4
  cardinality: 1

source:
  name: waterboy.sources.classic.cifar10
  batch_size: 128
#  batch_size: 32
  num_workers: 4
  normalize: True

  augmentations:
  - name: waterboy.augmentations.random_horizontal_flip
    mode: x
    tags: ["train"]
  - name: waterboy.augmentations.random_crop
    mode: x
    tags: ["train"]
    width: 32
    height: 32
    padding: 4
    padding_mode: 'reflect'


commands:
  train:
    name: waterboy.commands.train
    epochs: 300
    log_frequency: 100


    optimizer:
      name: waterboy.optimizers.sgd
      lr: 0.1
      weight_decay: 0.0001
      momentum: 0.9

#    optimizer:
#      name: waterboy.optimizers.adam
#      lr: 0.001
#      weight_decay: 0.001

#    scheduler:
#      name: waterboy.scheduler.multi_step
#      milestones: [20, 50, 100, 150]
#      gamma: 0.33

    scheduler:
      name: waterboy.scheduler.ladder
      ladder:
      - [150, 1.0]
      - [75, 0.1]
      - [75, 0.01]

#    scheduler:
#      name: waterboy.scheduler.reduce_lr_on_plateau
#      metric_name: val:accuracy
#      factor: 0.33
#      patience: 15
#      cooldown: 20
#      min_lr: 0.5e-6

  augvis:
    name: waterboy.commands.augvis
    seed: 1
    samples: 5
